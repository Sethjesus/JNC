import json
import random
import time
import os
from datetime import datetime

def push_to_git():
    os.system("git pull origin main --rebase")  # ğŸŸ¢ é€™è¡Œæ˜¯é—œéµ
    os.system("git add data.json")
    os.system(f'git commit -m "è‡ªå‹•æ›´æ–° {datetime.now()}"')
    os.system("git push origin main")

while True:
    data = {
        "pm25": round(random.uniform(10, 50), 2),
        "co2": round(random.uniform(400, 1000), 1)
    }

    with open("data.json", "w", encoding="utf-8") as f:
        json.dump(data, f, indent=2, ensure_ascii=False)

    print(f"[{datetime.now()}] âœ… è³‡æ–™å·²æ›´æ–°ï¼š", data)
    push_to_git()
    time.sleep(30)  # æ¯ 30 ç§’æ›´æ–°
